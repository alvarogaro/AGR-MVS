## Explicación Estructura Dockerfile.

* El contenedor que se va a montar para el Objetivo 5, es un contenedor enfocado al entorno de desarrollo,
por tanto se van a seguir una serie de pasos para su construcción.

* [Instalación de Poetry](https://python-poetry.org/docs#ci-recommendations): Para la instalación de poetry, tal y como podemos ver en la página oficial de poetry, se recomienda para los entornos de desarrollo que se use la última versión disponible. Siguiendo esto y las distintas maneras en las que ofrece como instalarlo (Mediante script, con pipx o con pip). En un principio se había optado por realizar la instalación con pip y por tanto usar un entorno virtual pero realmente esto tiene una serie de desventajas ya que de esta manera vamos a tener instalado pip en nuestra imagen cuando realmente no lo voy a usar, me está obligando a crear un entorno virtual que luego no voy a usar ya que poetry cuando instala las dependencias crea por defecto su propio entorno y finalmente el uso de variables de entorno que luego no vamos a utilizar. Por todo esto, finalmente se ha optado por la instalación mediante script y el uso de la herramienta curl.

* Entorno Virtual: Realmente como hemos comentado antes no va a ser necesario crear un entorno virtual para la instalación de poetry, igual que tampoco vamos a necesitar que poetry cree su propio entorno virtual ya que el hecho de tener un contenedor nos va a ser suficiente aislamiento del sistema. Por tanto, antes de instalar las dependencias vamos a configurar poetry para que no cree su propio entorno virtual. Todos estos motivos están especificados en el issue [30](https://github.com/alvarogaro/AGR-MVS/issues/30).

* Instalación Dependencias Poetry: Tras los pasos anteriores, poetry escribiría la cache en el raiz, por tanto luego a la hora de ejecutar el contenedor tendríamos problemas de permisos. Para solucionar esto se ha optado por crear un home para el usuario 1001 (Usuario que se va a usar para ejecutar el contenedor) y así que poetry escriba la cache en este directorio. En caso contrario, habría que dar permisos al usuario 1001 sobre la carpeta /.cache.

* La instalación de las dependencias, debido a que no se va a hacer un uso del entorno virtual, se va a realizar en la carpeta /usr/local/bin/python3.11/site-packages y en /usr/local/bin, aunque se ejecute con la opción --no-root. Dar permisos al usuario 1001 sobre estas carpetas no lo veo conveniente por tanto estos comandos se ejecutan con el superusuario.

* El directorio de trabajo que va a ser /app/test (Mediante workdir en caso de que no este creado, lo crea). Debido a que el usuario del runner de la Github action no es el mismo que el del contendor, vamos a tener que cambiar el propietario de la carpeta /app para que sea tanto del grupo como del usuario 1001, de manera que así a la hora de ejecutar el contenedor, como se va a hacer con el usuario 1001, este pueda tener permisos sobre la carpeta.